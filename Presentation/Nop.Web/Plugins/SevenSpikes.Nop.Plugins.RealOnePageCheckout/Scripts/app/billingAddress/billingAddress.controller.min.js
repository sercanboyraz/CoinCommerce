"use strict";function BillingAddressController(t,a,n,d){var r=this;function o(){if(angular.isDefined(r.config)){var e=!r.config.disableBillingAddressCheckoutStep;r.requiredFields={firstName:e,lastName:e,email:e,company:e&&!1!==r.billingData.settings.companyEnabled&&r.billingData.settings.companyRequired,country:e&&!1!==r.billingData.settings.countryEnabled,stateProvince:e&&r.billingData.settings.stateProvinceEnabled,city:e&&!1!==r.billingData.settings.cityEnabled&&r.billingData.settings.cityRequired,county:e&&!1!==r.billingData.settings.countyEnabled&&r.billingData.settings.countyRequired,address1:e&&!1!==r.billingData.settings.streetAddressEnabled&&r.billingData.settings.streetAddressRequired,address2:e&&!1!==r.billingData.settings.streetAddress2Enabled&&r.billingData.settings.streetAddress2Required,zipPostalCode:e&&!1!==r.billingData.settings.zipPostalCodeEnabled&&r.billingData.settings.zipPostalCodeRequired,phoneNumber:e&&!1!==r.billingData.settings.phoneEnabled&&r.billingData.settings.phoneRequired,faxNumber:e&&!1!==r.billingData.settings.faxEnabled&&r.billingData.settings.faxRequired}}}r.billingData={},r.configData={},r.configData.shipToSameAddressDisabled=!1,r.shipToSameAddress=!1,r.addressAttributeChanged=function(e,i){d.syncAttributeWithModel(i,e)},t.$on("checkoutDataLoaded",function(e,i){n.init(i);var s=n.get();angular.copy(s,r.billingData),r.config=i.configuration;var l=!1;angular.isDefined(i.configuration.pickUpInStoreModel)&&(l=JSON.parse(i.configuration.pickUpInStoreModel).pickUpInStore);r.configData.shipToSameAddressDisabled=!r.config.hasProductsRequiringShipping||l,r.shipToSameAddress=r.config.shipToSameAddress,!angular.isDefined(r.requiredFields)&&angular.isDefined(r.billingData.settings)&&o(),r.billingData.selectedBillingAddress&&r.billingData.selectedBillingAddress.customAddressAttributes&&0<r.billingData.selectedBillingAddress.customAddressAttributes.length&&!angular.isDefined(r.modelsData)&&(r.modelsData={},d.prepareDefaultSelectedValues(r.billingData.selectedBillingAddress,r.modelsData)),function(){var s=!0;a.$watch("{address: vm.billingData.selectedBillingAddress, shipToSameAddress: vm.shipToSameAddress}",function(e,i){e&&i&&!s?n.set(e):s=!1},!0),$(".billing-address .choose-address select").change(function(){t.$broadcast("addressChanged",{panel:"billing",shipToSameAddress:r.shipToSameAddress})})}()}),t.$on("refresh",function(e,i){if(null!=i.controller&&"BillingAddressController"!=i.controller)return!1;var s=n.get();angular.copy(s,r.billingData),!angular.isDefined(r.requiredFields)&&angular.isDefined(r.billingData.settings)&&o(),r.billingData.selectedBillingAddress&&r.billingData.selectedBillingAddress.customAddressAttributes&&0<r.billingData.selectedBillingAddress.customAddressAttributes.length&&!angular.isDefined(r.modelsData)&&(r.modelsData={},d.prepareDefaultSelectedValues(r.billingData.selectedBillingAddress,r.modelsData)),d.hideOverlay(".billing-address-loader")}),t.$on("togglePanel",function(e,i){angular.isDefined(i.hasProductsRequiringShipping)&&(r.configData.shipToSameAddressDisabled=!i.hasProductsRequiringShipping),angular.isDefined(i.pickUpInStore)&&(r.configData.shipToSameAddressDisabled=i.pickUpInStore)}),t.$on("setBillingAddressOverlay",function(){d.showOverlay(".billing-address-loader")}),t.$on("prepareDefaultSelectedValuesForCustomAddressAttributes",function(e,i){"billing"==i.panel&&setTimeout(function(){a.$apply(function(){d.prepareDefaultSelectedValues(r.billingData.selectedBillingAddress,r.modelsData)})})})}angular.module("realOnePageCheckout.billingAddress").controller("BillingAddressController",BillingAddressController),BillingAddressController.$inject=["$rootScope","$scope","billingAddressContext","objectUtility"];