"use strict";function PickupInStoreController(i,t,r){var c=this;c.pickupInStoreData={},c.configData={},c.configData.pickupInStoreIsVisible=!0,c.configData.pickupInStoreCheckboxDisabled=!1,c.pickupInStoreModel={};var p=!(c.selectedPickupPoint={}),a=!1,u=!1;function l(){var i=c.pickUpInStoreModel;i&&(c.configData.pickupInStoreIsVisible=i.allowPickUpInStore&&0<i.pickupPoints.length&&a&&!u)}i.$on("refresh",function(i,e){if(null!=e.controller&&"PickupInStoreController"!=e.controller)return!1;var n=r.get();angular.copy(n,c.pickupInStoreData)}),c.pickUpPointChanged=function(i){if(p&&i){var e=c.selectedPickupPoint.Id+"___"+c.selectedPickupPoint.ProviderSystemName;r.set(p,e)}},i.$on("pickupPointMarkerClicked",function(i,e){c.selectedPickupPoint=e.pickUpPoint,c.pickUpPointChanged()}),i.$on("checkoutDataLoaded",function(i,e){var n,o={};angular.isDefined(e.configuration.pickUpInStoreModel)&&(o=JSON.parse(e.configuration.pickUpInStoreModel)),r.init(o),angular.isDefined(e.configuration.hasProductsRequiringShipping)&&(a=e.configuration.hasProductsRequiringShipping),angular.isDefined(e.configuration.shipToSameAddress)&&(u=e.configuration.shipToSameAddress),t.$evalAsync(function(){c.config=e.configuration,o&&(c.pickUpInStoreModel=o,c.selectedPickupPoint=o.pickupPoints[0],c.pickupInStoreData.pickupInStore=o.pickUpInStore,p=o.pickUpInStore),l()}),n=!0,t.$watch("vm.pickupInStoreData.pickupInStore",function(i,e){"boolean"!=typeof i||n?n=!1:(p=i,r.set(p,c.selectedPickupPoint.Id+"___"+c.selectedPickupPoint.ProviderSystemName))},!0)}),i.$on("togglePanel",function(i,e){angular.isDefined(e.hasProductsRequiringShipping)&&(a=e.hasProductsRequiringShipping),e&&angular.isDefined(e.shipToSameAddress)&&(u=e.shipToSameAddress),l()})}angular.module("realOnePageCheckout.pickupInStore").controller("PickupInStoreController",PickupInStoreController),PickupInStoreController.$inject=["$rootScope","$scope","pickupInStoreContext"];