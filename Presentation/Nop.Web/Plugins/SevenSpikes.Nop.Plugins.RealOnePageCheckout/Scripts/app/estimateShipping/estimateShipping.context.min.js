"use strict";function estimateShippingContext(i,t,e,n,a){var o;return{init:function(t){(o=t.estimateShipping||{}).selectedEstimateShippingCountry={},o.selectedStateProvince={},o.shippingOptions=[],o.warnings=[]},get:function(){return o},set:function(t){i.$broadcast("estimateShippingContextChanging");var e=o;t.country.value!=e.selectedEstimateShippingCountry.value&&(function(t){i.$broadcast("estimateShippingContextChanging",{countryId:t}),n.getStatesByCountryId(t).then(function(t){o.availableStates=t.data,i.$broadcast("estimateShippingContextChanged"),a(function(){$(document).trigger({type:"addressStatesUpdated",statesDropdownId:"#estimateShippingStateProvince"})},100)})}(t.country.value),angular.copy(t.country,o.selectedEstimateShippingCountry),o.isButtonEnabled=0!=t.country.value);t.stateProvince.value!=e.selectedStateProvince.value&&angular.copy(t.stateProvince,o.selectedStateProvince);t.zipPostalCode!=e.zipPostalCode&&(o.selectedEstimateShippingZipPostalCode=t.zipPostalCode);t.estimateShipping&&((e={}).countryId=t.country.value,t.stateProvince&&(e.stateProvinceId=t.stateProvince.value),t.zipPostalCode&&(e.zipPostalCode=t.zipPostalCode),n.calculateEstimateShipping(e).then(function(t){angular.copy(t.data.shippingOptions,o.shippingOptions),angular.copy(t.data.warnings,o.warnings),i.$broadcast("estimateShippingContextChanged")}))}}}angular.module("realOnePageCheckout.estimateShipping").factory("estimateShippingContext",estimateShippingContext),estimateShippingContext.$inject=["$rootScope","$q","api","estimateShippingService","$timeout"];