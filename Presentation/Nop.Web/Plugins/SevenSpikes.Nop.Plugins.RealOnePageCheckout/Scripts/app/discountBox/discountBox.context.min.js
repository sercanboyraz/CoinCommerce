"use strict";function discountBoxContext(n,t,i,r,u){function s(i){n.$broadcast("discountBoxContextChanging",{applyDiscountCode:!0});r.applyDiscountCode(i).then(function(t){f=t.data;e.setState(f);n.$broadcast("discountBoxContextChanged",{isDiscountApplied:f.isApplied})},function(i){return f=e.getLastState(),n.$broadcast("discountBoxContextChanged"),t.reject(i)})}function h(i){n.$broadcast("discountBoxContextChanging",{removeDiscountCode:!0});r.removeDiscountCode(i).then(function(t){f=t.data;e.setState(f);n.$broadcast("discountBoxContextChanged",{isDiscountRemoved:!0})},function(i){return f=e.getLastState(),n.$broadcast("discountBoxContextChanged"),t.reject(i)})}function c(n){f=n.orderSummary.discountBox;e.setState(f)}function l(){return f}function a(n){n.applyDiscountCode&&s(n.discountCouponCode);n.removeDiscountCodeWithId>0&&h(n.removeDiscountCodeWithId)}var o={init:c,get:l,set:a},f,e=u.instance();return o}angular.module("realOnePageCheckout.discountBox").factory("discountBoxContext",discountBoxContext);discountBoxContext.$inject=["$rootScope","$q","api","discountBoxService","stateHolder"];