"use strict";function objectUtility(n,t){function f(n,t){switch(n.attributeControlType){case"Checkboxes":angular.forEach(n.values,function(n){n.isPreSelected=t[n.id]});break;case"RadioList":case"DropdownList":angular.forEach(n.values,function(n){n.isPreSelected=!1});t.isPreSelected=!0;break;case"TextBox":case"MultilineTextbox":n.defaultValue=t}}function i(n){for(var r,f,i=0,t=0;t<$(n).length;t++)r=parseInt($(n[t]).val()),f=u(r),i+=f;return i}function r(){var t=sevenSpikesCore.getHiddenValFromDom("#flyoutShoppingCartUrlROPC"),n=sevenSpikesCore.getHiddenValFromDom("#flyoutShoppingCartPanelSelectorROPC");$(n).length>0&&$.ajax({cache:!1,type:"GET",url:t,success:function(t){var i=$(t).filter(n);$(n).replaceWith(i)},error:function(){console.log("Refreshing flyout shopping cart failed.")}})}function e(){var n=$(".cart .quantity select"),t=$(".cart .quantity input"),f=sevenSpikesCore.getHiddenValFromDom("#shoppingCartMenuLinkSelectorROPC"),u,e;if($(f).length>0){if(!n&&!t)return;u=0;n&&n.length>0&&(u+=i(n));t&&t.length>0&&(u+=i(t));e="("+u+")";$(f).html(e);r()}}function o(n){var i=sevenSpikesCore.getHiddenValFromDom("#shoppingCartMenuLinkSelectorROPC"),t,f,u,e,o;$(i).length>0&&n&&(t=$(i).text(),isNaN(t)||(t=parseInt(t)),f=/\(([^)]+)\)/,u=f.exec($(i).text()),u&&(t=u[1]),isNaN(n)&&(n.value?n=parseInt(n.value):n.text&&(n=parseInt(n.text))),e=t-n,isNaN(e)||(o="("+(t-n)+")",$(i).html(o),r()))}function u(n){var t=n;return(!n||isNaN(n)||n<=0)&&(t=1),t}function s(n,t){n.id=undefined;var i;angular.forEach(t,function(t){if(i=t.id,t.id=undefined,n.customProperties=t.customProperties,JSON.stringify(t)==JSON.stringify(n)){n.id=i;t.id=i;return}t.id=i})}function h(n){var t=[];return angular.forEach(n,function(n){t.push({value:n.id.toString(),text:n.name})}),t}function c(n){var t=arguments||[];return n.replace(/{([0-9]+)}/g,function(n,i){return t[++i]})}function l(n){return t.trustAsHtml(n)}function a(t){for(var i=0;i<t.length;i++)n.$broadcast(t[i])}function v(n){var i=$(n),t=i.parent().not("#checkoutForm"),r=t.height();i.closest(".section, .checkout-panel").addClass("panel-loading");(t.css("box-sizing")=="border-box"||t.css("-webkit-box-sizing")=="border-box"||t.css("-moz-box-sizing")=="border-box")&&(r=t.outerHeight());r>0&&t.css("height",r+"px");i.show()}function y(n){setTimeout(function(){var t=$(n);t.parent().css("height","");t.closest(".section, .checkout-panel").removeClass("panel-loading");t.fadeOut()},600)}function p(){var n=$(".complete-button > button"),i=n.text(),t=n.data("complete"),r=n.data("processing");i.indexOf(t)!==-1?n.text(r):n.text(t)}function w(n){document.location.href=n}function b(n,t){for(var i,r,u,f,e=0;e<n.customAddressAttributes.length;e++)if(i=n.customAddressAttributes[e],t[i.id]||(t[i.id]={}),i.values&&i.values.length>0)if(r=$.grep(i.values,function(n){return n.isPreSelected}),i.attributeControlType=="RadioList")r.length>0&&(t[i.id].radioModel=r[0].id);else if(i.attributeControlType=="Checkboxes")for(t[i.id].checkboxModel={},u=0;u<i.values.length;u++)t[i.id].checkboxModel[i.values[u].id]=i.values[u].isPreSelected;else i.attributeControlType=="DropdownList"&&(r.length>0?t[i.id].dropdownListModel=r[0]:i.isRequired&&(t[i.id].dropdownListModel=i.values[0]));else f=i.attributeControlType+"Model",f=f.charAt(0).toLowerCase()+f.slice(1),t[i.id][f]=i.defaultValue}function k(n){return n.charAt(0).toLowerCase()+n.slice(1)}return{prepareStatesModel:h,stringFormat:c,trustAsHtml:l,raiseEvents:a,showOverlay:v,hideOverlay:y,toggleSubmitButtonText:p,redirectTo:w,equalize:s,validateQuantity:u,changeNumberOfItemsWhenCartItemsQuantityIsUpdated:e,changeNumberOfItemsWhenEntireItemIsRemoved:o,prepareDefaultSelectedValues:b,uncapitalizeFirstLetter:k,syncAttributeWithModel:f}}angular.module("realOnePageCheckout.utility").factory("objectUtility",objectUtility);objectUtility.$inject=["$rootScope","$sce","$window","storeLocation"];