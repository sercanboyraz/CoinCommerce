function dataDispatcher(r,a,e,t){var o,s=e,n=[],i=[];function d(e){r.$broadcast("refresh",{controller:e})}function h(e){s.pop(e),0===s.length&&(e=o.updateOrderSummaryOnOrderTotalUpdate?"resetOrderSummaryData":"resetOrderTotalData",r.$broadcast(e))}function p(e){var t=!1;if(e&&o&&"BillingAddress"==o.addressTypeOnWhichTheTaxIsBasedOn&&0<o.ajaxUpdateOrderTotalBasedOnTaxAddressOnAddressFieldsChange.length){if(null!=e.newVatNumber)return!0;for(var n=o.ajaxUpdateOrderTotalBasedOnTaxAddressOnAddressFieldsChange,a=0;a<n.length;a++)if(e.hasOwnProperty("new"+n[a])){t=!0;break}}return t}function u(e){var t=!1;if(e&&o&&0<o.ajaxUpdatePaymentMethodsOnAddressFieldsUpdate.length)for(var n=o.ajaxUpdatePaymentMethodsOnAddressFieldsUpdate,a=0;a<n.length;a++)if(e.hasOwnProperty("new"+n[a])){t=!0;break}return t}function l(){return o&&o.ajaxUpdateOrderTotalOnPaymentMethodsUpdate}function g(e){return e&&null!=e.useMyRewardPoints}function C(e){return e&&Boolean(e.isMyRewardPointsChecked||null!=e.useMyRewardPoints||e.error)}function c(e){var t=!1;if(e&&o&&"ShippingAddress"==o.addressTypeOnWhichTheTaxIsBasedOn&&0<o.ajaxUpdateOrderTotalBasedOnTaxAddressOnAddressFieldsChange.length)for(var n=o.ajaxUpdateOrderTotalBasedOnTaxAddressOnAddressFieldsChange,a=0;a<n.length;a++)if(e.hasOwnProperty("new"+n[a])){t=!0;break}return t}function O(e){var t=!1;if(e&&o&&0<o.ajaxUpdateShippingMethodsOnAddressFieldsUpdate.length)for(var n=o.ajaxUpdateShippingMethodsOnAddressFieldsUpdate,a=0;a<n.length;a++)if(e.hasOwnProperty("new"+n[a])){t=!0;break}return t}function m(){return o&&o.ajaxUpdateOrderTotalOnShippingMethodsUpdate}function y(e){return e&&e.hasPriceAdjustment}return t.getCheckoutData(),r.$on("checkoutDataLoaded",function(e,t){o=t.configuration,r.$broadcast("hideConfirmOrderOverlay"),setTimeout(function(){$(".ropc select.not-loaded").removeClass("not-loaded"),$.event.trigger("nopOnePageCheckoutPanelsLoadedEvent")})}),r.$on("addressChanged",function(e,t){r.$broadcast("prepareDefaultSelectedValuesForCustomAddressAttributes",{panel:t.panel,shipToSameAddress:t.shipToSameAddress})}),r.$on("shipToSameAddress",function(e,t){t&&angular.isDefined(t.shipToSameAddress)&&r.$broadcast("togglePanel",{shipToSameAddress:t.shipToSameAddress}),t&&angular.isDefined(t.currentBillingAddress)&&t.shipToSameAddress&&r.$broadcast("updateShippingAddress",{address:angular.copy(t.currentBillingAddress)})}),r.$on("billingContextChanging",function(e,t){var n=p(t),t=u(t);n&&s.push("billingContextChanging"),(n||t)&&a.raiseEvents(["setBillingAddressOverlay"]),t&&a.raiseEvents(["setPaymentMethodsOverlay"]),n&&a.raiseEvents(["setOrderTotalOverlay"])}),r.$on("billingContextChanged",function(e,t){var n=p(t),a=u(t);n&&h("billingContextChanging"),a&&r.$broadcast("resetPaymentMethodsData",{newCountryId:t.newCountryId}),t&&null!=t.newVatNumber&&r.$broadcast("resetOrderTotalData"),d("BillingAddressController")}),r.$on("shippingContextChanging",function(e,t){var n=O(t),t=c(t);t&&s.push("shippingContextChanging"),(n||t)&&a.raiseEvents(["setShippingAddressOverlay"]),n&&a.raiseEvents(["setShippingMethodsOverlay"]),t&&a.raiseEvents(["setOrderTotalOverlay"])}),r.$on("shippingContextChanged",function(e,t){t&&(c(t)&&h("shippingContextChanging"),O(t)&&r.$broadcast("resetShippingMethodsData",{newCountryId:t.newCountryId}),d("ShippingAddressController",t.newCountryId))}),r.$on("paymentMethodsContextChanging",function(e,t){(l()||g(t))&&(s.push("paymentMethodsContextChanging"),a.raiseEvents(["setOrderTotalOverlay"])),C(t)&&a.raiseEvents(["setPaymentMethodsOverlay"])}),r.$on("paymentMethodsContextChanged",function(e,t){(l()||g(t))&&(h("paymentMethodsContextChanging"),0<n.length&&n.pop()()),C(t)&&r.$broadcast("resetPaymentMethodsData"),d("PaymentMethodsController")}),r.$on("shippingMethodsContextChanging",function(e,t){m()&&(s.push("shippingMethodsContextChanging"),a.raiseEvents(["setOrderTotalOverlay"])),a.raiseEvents(["setShippingMethodsOverlay"])}),r.$on("shippingMethodsContextChanged",function(e,t){(function(e){if(e&&e.newShippingMethodSelected&&e.oldShippingMethodSelected&&0!=e.newShippingMethodSelected.shippingOption.rate-e.oldShippingMethodSelected.shippingOption.rate)return 1})(t)&&(r.$broadcast("resetPaymentMethodsData"),a.raiseEvents(["setPaymentMethodsOverlay"])),m()&&(h("shippingMethodsContextChanging"),0<i.length&&i.pop()()),d("ShippingMethodsController")}),r.$on("orderSummaryContextChanging",function(e,t){var n;o.updateOrderSummaryOnOrderTotalUpdate||s.push("orderSummaryContextChanging"),t&&(t.updateCartItem||t.removeCartItem)&&(n=["setOrderSummaryOverlay","setPaymentMethodsOverlay","setOrderTotalOverlay"],(o.ajaxUpdateShippingMethodsOnCartUpdate||t.removeCartItem)&&n.push("setShippingMethodsOverlay"),t.removeCartItem&&n.push("setCheckoutAttributesOverlay"),a.raiseEvents(n))}),r.$on("orderSummaryContextChanged",function(e,t){return o.updateOrderSummaryOnOrderTotalUpdate||h("orderSummaryContextChanging"),t&&(t.updateCartItem||t.removeCartItem)?(r.$broadcast("resetOrderSummaryData"),r.$broadcast("resetPaymentMethodsData"),(o.ajaxUpdateShippingMethodsOnCartUpdate||t.removeCartItem)&&r.$broadcast("resetShippingMethodsData"),void(t.removeCartItem&&r.$broadcast("resetCheckoutAttributesData"))):(o.updateOrderSummaryOnOrderTotalUpdate&&r.$broadcast("resetOrderTotalData"),void d())}),r.$on("orderTotalContextChanged",function(e,t){t&&0==t.hasProductsRequiringShipping&&r.$broadcast("togglePanel",{hasProductsRequiringShipping:t.hasProductsRequiringShipping}),d("OrderTotalController")}),r.$on("discountBoxContextChanging",function(e,t){s.push("discountBoxContextChanging"),t&&(t.applyDiscountCode||t.removeDiscountCode)&&a.raiseEvents(["setDiscountBoxOverlay","setOrderTotalOverlay"])}),r.$on("discountBoxContextChanged",function(e,t){h("discountBoxContextChanging"),t&&(t.isDiscountApplied||t.isDiscountRemoved)&&(a.raiseEvents(["setPaymentMethodsOverlay","setShippingMethodsOverlay","setOrderSummaryOverlay"]),r.$broadcast("resetPaymentMethodsData"),r.$broadcast("resetShippingMethodsData"),r.$broadcast("resetOrderSummaryData")),d("DiscountBoxController")}),r.$on("giftCardBoxContextChanging",function(e,t){s.push("giftCardBoxContextChanging"),t&&(t.applyGiftCard||t.removeGiftCard)&&a.raiseEvents(["setGiftCardBoxOverlay","setOrderTotalOverlay"])}),r.$on("giftCardBoxContextChanged",function(e,t){h("giftCardBoxContextChanging"),t&&(t.isGiftCardApplied||t.isGiftCardRemoved)&&(a.raiseEvents(["setPaymentMethodsOverlay"]),r.$broadcast("resetPaymentMethodsData")),d("GiftCardBoxController")}),r.$on("removeGiftCard",function(e,t){t.giftCardId&&r.$broadcast("removeGiftCardById",{giftCardId:t.giftCardId})}),r.$on("estimateShippingContextChanging",function(e,t){t&&a.raiseEvents(["setEstimateShippingOverlay"])}),r.$on("estimateShippingContextChanged",function(e,t){d("EstimateShippingController")}),r.$on("checkoutAttributesContextChanging",function(e,t){y(t)&&(s.push("checkoutAttributesContextChanging"),a.raiseEvents(["setOrderTotalOverlay"])),a.raiseEvents(["setCheckoutAttributesOverlay"])}),r.$on("checkoutAttributesContextChanged",function(e,t){var n;(n=t)&&n.hasPriceAdjustment&&(a.raiseEvents(["setPaymentMethodsOverlay"]),r.$broadcast("resetPaymentMethodsData")),y(t)&&h("checkoutAttributesContextChanging"),d("CheckoutAttributesController")}),r.$on("confirmOrderContextChanging",function(){a.raiseEvents(["setConfirmOrderOverlay"])}),r.$on("confirmOrderContextChanged",function(){r.$broadcast("hideConfirmOrderOverlay"),d("OrderConfirmController")}),r.$on("pickupInStoreContextChanging",function(){s.push("pickupInStoreContextChanging"),r.$broadcast("setOrderTotalOverlay")}),r.$on("pickupInStoreContextChanged",function(e,t){h("pickupInStoreContextChanging"),a.raiseEvents(["setPaymentMethodsOverlay","resetPaymentMethodsData"]),r.$broadcast("togglePanel",{pickUpInStore:t.pickupInStore}),t.pickupInStore||a.raiseEvents(["setShippingMethodsOverlay","resetShippingMethodsData"]),d("PickupInStoreController")}),r.$on("errorOccured",function(e,t){t&&r.$broadcast("pushError",t)}),r.$on("submitForm",function(e,t){t&&r.$broadcast("submit")}),{}}angular.module("realOnePageCheckout.dispatchers").factory("dataDispatcher",dataDispatcher),dataDispatcher.$inject=["$rootScope","objectUtility","namedQueueUtility","dataService"];