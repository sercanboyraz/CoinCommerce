!function(t,u,i){var l,n="#color-squares-info";function s(t,e){if(e&&0<e.length)for(var r=0;r<e.length;r++)o=t,a=e[r],d=void 0,(d=i.getAttrValFromDom(n,"data-productbox-container-selector"))&&(0<(d=a.productElement.find(d)).find("ul.attribute-squares").length||d&&a.productId&&0<a.productId&&(a=a.productId,(o=u(o).filter("ul[data-productId='"+a+"']"))&&0<o.length&&(u(d).append(o),u(d).addClass("active"),(a=u(".product-item").has("[data-productid="+a+"]")).find(" .second-product-image").remove(),a.find(".product-box-attribute-square.preselected").click())));var o,a,d}t.getColorSquares=function(){var e,r=(e=[],u(l).each(function(){var t=u(this).attr("data-productid");t&&0<t&&(t={productId:t,productElement:u(this)},e.push(t))}),e);if(r&&0!==r.length){for(var t=[],o=0;o<r.length;o++){var a=r[o];a.hasOwnProperty("productId")&&t.push(a.productId)}var d={productIds:t},c=i.getAttrValFromDom(n,"data-retrieve-color-squares-url");u.ajax({cache:!1,type:"POST",data:u.toJSON(d),contentType:"application/json; charset=utf-8",url:c}).done(function(t){t&&(s(t,r),u.event.trigger({type:"colorSquaresLoadingCompleteEvent"}))})}},u(document).ready(function(){(l=i.getAttrValFromDom(n,"data-productbox-selector"))&&t.getColorSquares()}),u(document).on("click",".product-box-attribute-square",function(){var t,e,r,o=u(this),a=o.closest("li");a.hasClass("selected-value")||(t=i.getAttrValFromDom("#color-squares-info","data-product-attribute-change-url"),(e=o.closest(".product-item").data("productid"))&&0<e&&((r={})[o.attr("name")]=o.attr("value"),addAntiForgeryToken(r),u.ajax({cache:!1,url:t+"?productId="+e+"&validateAttributeConditions=true&loadpicture=true",data:r,type:"POST",success:function(t){var e;t.price&&(e=i.getAttrValFromDom("#color-squares-info","data-productbox-price-selector"),0<(e=o.closest(".product-item").find(e)).length&&e.text(t.price)),t.pictureDefaultSizeUrl&&o.closest(".product-item").find(".picture img").attr("src",t.pictureDefaultSizeUrl)}})),a.addClass("selected-value"),a.siblings(".selected-value").removeClass("selected-value"))}),u(document).on("nopAjaxFiltersFiltrationCompleteEvent newProductsAddedToPageEvent",t.getColorSquares)}(window.colorSquares=window.colorSquares||{},jQuery,sevenSpikesCore);